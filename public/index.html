<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star_Collector</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>

    <style>
        /* í˜ì´ì§€ ì „ì²´ë¥¼ Flexboxë¡œ ì¤‘ì•™ ì •ë ¬ */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #main-container {
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: flex-start;
            padding-left: 100px;
        }

        /* ê²Œì„ ìº”ë²„ìŠ¤ë¥¼ ê°ì‹¸ëŠ” div ì„¤ì • */
        #game-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 800px;
            height: 600px; /* ê²Œì„ í™”ë©´ ë†’ì´ */
        }

        /* ì ìˆ˜ ë­í‚¹ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        #ranking-container {
            width: 300px; /* ì ìˆ˜ ë­í‚¹ì˜ ë„ˆë¹„ */
            height: 600px; /* ê²Œì„ í™”ë©´ì˜ ë†’ì´ì™€ ì¼ì¹˜ */
            border: 1px solid #ccc;
            padding: 20px;
            background-color: #f9f9f9;
            box-sizing: border-box; /* íŒ¨ë”©ì´ ë°•ìŠ¤ í¬ê¸°ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ ì„¤ì • */
        }

        /* ë‹‰ë„¤ì„ì„ ìƒë‹¨ì— ê³ ì •ì‹œí‚¤ê¸° ìœ„í•œ ìŠ¤íƒ€ì¼ */
        #nickname-display {
            font-size: 18px;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.7); /* ë°˜íˆ¬ëª… ë°°ê²½ */
            color: white;
            padding: 5px;
            border-radius: 5px;
            margin-bottom: 10px; /* ë‹‰ë„¤ì„ê³¼ Top 10 Scores ì‚¬ì´ì— ì—¬ë°± ì¶”ê°€ */
        }

        h2 {
            text-align: center;
        }

        ul {
            list-style-type: none;
            padding: 0;
        }

        li {
            margin: 5px 0;
            padding: 5px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
        }

        .gold {
            color: gold; 
            font-weight: bold;
            text-shadow: 
                -0.6px -0.6px 0 #000,  
                0.6px -0.6px 0 #000,
                -0.6px 0.6px 0 #000,
                0.6px 0.6px 0 #000; /* ì–‡ì€ ê²€ì€ìƒ‰ í…Œë‘ë¦¬ íš¨ê³¼ */
        }
        .silver { color: silver; font-weight: bold; 
            font-weight: bold;
            text-shadow: 
                -0.6px -0.6px 0 #000,  
                0.6px -0.6px 0 #000,
                -0.6px 0.6px 0 #000,
                0.6px 0.6px 0 #000; /* ì–‡ì€ ê²€ì€ìƒ‰ í…Œë‘ë¦¬ íš¨ê³¼ */
        }
        .bronze { color: #cd7f32; font-weight: bold; }

        .btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            font-size: 16px;
            text-align: center;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }

        .btn:hover {
            background-color: #45a049;
        }

         /* íŒ¨ì¹˜ ë…¸íŠ¸ ê³µê°„ ìŠ¤íƒ€ì¼ */
         #patch-notes {
            width: 200px;
            height: 600px; /* ê²Œì„ í™”ë©´ ë†’ì´ì™€ ì¼ì¹˜ */
            background-color: #f4f4f4;
            border-right: 1px solid #ccc;
            padding: 20px;
            box-sizing: border-box; /* íŒ¨ë”©ì´ ë°•ìŠ¤ í¬ê¸°ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ ì„¤ì • */
            box-shadow: 2px 0px 5px rgba(0,0,0,0.1); /* ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì‚´ì§ ê·¸ë¦¼ì íš¨ê³¼ */
        }
    </style>
</head>
<body>
    <div id="main-container">
        <div id="patch-notes">
            <h2>Patch Notes</h2>
            <p>Version 1.0.1 - ë³´ì•ˆì„ ê°•í™”í–ˆìŠµë‹ˆë‹¤ ì´ì œ ë¬´ì‘ìœ„ post ìš”ì²­ì„ ë°›ì§€ ì•Šì„ê²ë‹ˆë‹¤.</p>
            
            <!-- ì¶”ê°€ë¡œ íŒ¨ì¹˜ ì‚¬í•­ì„ ì—¬ê¸°ì— ì ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤ -->
        </div>
        <div id="game-container"></div>

        <div id="ranking-container">
            <div id="nickname-display"></div> <!-- ë‹‰ë„¤ì„ì„ í‘œì‹œí•˜ëŠ” ë¶€ë¶„ -->

            <h2>Top 10 Scores</h2>
            <ul id="ranking-list"></ul>
            <button class="btn" id="view-rankings">View All Rankings</button>
            <button class="btn" id="change-nickname">Change Nickname</button> <!-- ë‹‰ë„¤ì„ ë³€ê²½ ë²„íŠ¼ -->
        </div>
    </div>

    <script src="game.js"></script>

    <script>
        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ëœ ë‹‰ë„¤ì„ì„ ì‚­ì œí•˜ê³  í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ëŠ” í•¨ìˆ˜
        function changeNickname() {
            localStorage.removeItem('playerNickname'); // ë‹‰ë„¤ì„ ì‚­ì œ
            location.reload(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
        }

        // 'Change Nickname' ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
        document.getElementById('change-nickname').addEventListener('click', changeNickname);

        // 'View All Rankings' ë²„íŠ¼ í´ë¦­ ì‹œ rankings í˜ì´ì§€ë¡œ ì´ë™
        document.getElementById('view-rankings').addEventListener('click', function() {
            window.location.href = '/rankings'; // ë­í‚¹ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜
        });

        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ ë‹‰ë„¤ì„ ê°€ì ¸ì˜¤ê¸°
        function displayNickname() {
            const nicknameDisplay = document.getElementById('nickname-display');
            const savedNickname = localStorage.getItem('playerNickname') || 'Player';
            nicknameDisplay.textContent = `Nickname: ${savedNickname}`;
        }

        // ë‹‰ë„¤ì„ì„ í‘œì‹œí•˜ëŠ” ë¡œì§
        window.onload = function() {
            displayNickname(); // ë‹‰ë„¤ì„ì„ í‘œì‹œ
            fetchAndDisplayScores(); // ì ìˆ˜ ë°ì´í„°ë¥¼ í‘œì‹œ
        };

        // ì ìˆ˜ ë°ì´í„° ê°€ì ¸ì˜¤ëŠ” ë¡œì§ (ê¸°ì¡´ ì½”ë“œ)
        async function fetchAndDisplayScores() {
            try {
                const response = await fetch('/scores/top10'); 
                const data = await response.json();

                if (!Array.isArray(data) || data.length === 0) {
                    throw new Error('No scores found or invalid format.');
                }

                const rankingList = document.getElementById('ranking-list');
                rankingList.innerHTML = ''; 

                data.forEach((score, index) => {
                    const listItem = document.createElement('li');
                    let className = '';

                    // 1ë“±ì—ê²Œ ê¸ˆ íš¨ê³¼ ë° ì™•ê´€ ì´ëª¨ì§€ ì¶”ê°€
                    if (index === 0) {
                        className = 'gold';
                        listItem.innerHTML = `ğŸ‘‘ ${index + 1}. ${score.user_nickname}: ${score.user_score} ì `;
                    } else if (index === 1) {
                        className = 'silver'; // 2ë“±ì—ê²Œ ì€ íš¨ê³¼
                        listItem.innerHTML = `${index + 1}. ${score.user_nickname}: ${score.user_score} ì `;
                    } else if (index === 2) {
                        className = 'bronze'; // 3ë“±ì—ê²Œ ë™ íš¨ê³¼
                        listItem.innerHTML = `${index + 1}. ${score.user_nickname}: ${score.user_score} ì `;
                    } else {
                        listItem.innerHTML = `${index + 1}. ${score.user_nickname}: ${score.user_score} ì `;
                    }

                    listItem.className = className; // í´ë˜ìŠ¤ ì´ë¦„ ì„¤ì •
                    rankingList.appendChild(listItem);
                });
            } catch (error) {
                console.error('Error fetching scores:', error);
            }
        }
    </script>
</body>
</html>
